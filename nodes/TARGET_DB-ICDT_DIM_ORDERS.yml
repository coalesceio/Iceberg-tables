fileVersion: 1
id: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
name: ICDT_DIM_ORDERS
operation:
  config:
    baseLocation: DIM
    clusterKey: true
    clusterKeyConfig:
      items:
        - columnName:
            columnCounter: 54cf0642-9199-4a5b-a72a-217dbc34789a
            stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
    cpygrants: true
    externalVolume: sficebergextvol1
    initialize: ON_CREATE
    lagSpecification:
      items:
        - {}
    orderBy:
      items:
        - colName:
            columnCounter: fee9b78d-0ac9-4781-8f35-220671d71d0a
            stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
    orderByDateTime:
      items:
        - colNameDate:
            columnCounter: d650b014-6bdd-48e6-9171-82b161882d94
            stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
          colNameTimestamp: null
    orderseq:
      items:
        - {}
    partitionBy:
      items:
        - partColName:
            columnCounter: 54cf0642-9199-4a5b-a72a-217dbc34789a
            stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
    recordVersioning: Datetime Column
    recordorderBy:
      items:
        - {}
    refresh_mode: AUTO
    tgtLagSpecification: DOWNSTREAM
    warehouseName: dev_wh_xs
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 173ce5e8-377c-4448-bdbd-104b65354abf
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        isSurrogateKey: true
        name: ICDT_DIM_ORDERS_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ dimensionHistoryPk() }}"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54cf0642-9199-4a5b-a72a-217dbc34789a
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_ORDERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70cb6143-a341-4a2a-97dc-5ec2e4daca10
                stepCounter: 23e9dbde-be57-4701-a60b-518adc3935a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8c7e468-000c-4f5a-aa7e-6c1d25ad1d89
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aaba67c5-20f4-4831-9750-f6b28ddfbd2b
                stepCounter: 23e9dbde-be57-4701-a60b-518adc3935a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfd44bd1-58e1-4d96-926f-fa7209f3f18c
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: O_ORDERSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 235857a5-4e73-45f7-91b0-7683418171a2
                stepCounter: 23e9dbde-be57-4701-a60b-518adc3935a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ab558b6-c060-4486-a463-49378c1c4a1e
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: O_TOTALPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b8d990c-19f3-4377-b2a3-8bc4cc504ccc
                stepCounter: 23e9dbde-be57-4701-a60b-518adc3935a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d650b014-6bdd-48e6-9171-82b161882d94
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: DATE
        description: ""
        name: O_ORDERDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b73333c0-297b-45bd-a624-0da9a2e7109f
                stepCounter: 23e9dbde-be57-4701-a60b-518adc3935a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef22979-ad87-4e39-96a0-08118989d556
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbc49458-19ba-4895-81a5-f63c32a7e7eb
                stepCounter: 23e9dbde-be57-4701-a60b-518adc3935a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef020c98-3d86-4d87-96f4-f387782e8874
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_CLERK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1358e82e-e76e-4a19-9ace-ab9448a5a4ec
                stepCounter: 23e9dbde-be57-4701-a60b-518adc3935a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d095e625-f0f0-4898-84ce-c522f69f1455
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_SHIPPRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbc188bc-3b20-4f09-80b3-4b8ebc690181
                stepCounter: 23e9dbde-be57-4701-a60b-518adc3935a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ef2373d-9955-400d-8f13-52a17085dcef
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: VARCHAR(79)
        description: ""
        name: O_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 917d0e08-bbbb-4a28-83b7-7588735eb558
                stepCounter: 23e9dbde-be57-4701-a60b-518adc3935a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fee9b78d-0ac9-4781-8f35-220671d71d0a
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: TIMESTAMP_LTZ(9)
        description: ""
        name: O_LOAD_TIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b144342-1fe1-4e64-a4f9-ec27b4fa9706
                stepCounter: 23e9dbde-be57-4701-a60b-518adc3935a4
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 38708b35-f58e-4ac9-b25e-692909b1a7fe
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemStartDate: true
        name: RECORD_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{% if config.recordVersioning not in ('Integer Column') %} {{ order_by_col().split(',')[0] }} {% else %} {{ order_by_col_int().split(',')[0] }} {% endif %}"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1514e09c-ac61-4df6-b26d-24da87a59ae1
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemEndDate: true
        name: RECORD_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD ( {% if config.recordVersioning not in ('Integer Column')%} {{ order_by_col().split(',')[0] }} {% else %} {{ order_by_col_int().split(',')[0] }} {% endif %} ) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 82510946-abe2-4176-9de4-0b9430fb8a57
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: NUMBER(1, 0)
        defaultValue: ""
        description: ""
        isRecordCurrent: true
        name: RECORD_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CASE WHEN ( LEAD ( {% if config.recordVersioning not in ('Integer Column') %} {{ order_by_col().split(',')[0] }} {% else %} {{ order_by_col_int().split(',')[0] }} {% endif %} ) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc) ) IS NULL THEN 1 ELSE 0 END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e8c54dc2-d846-423b-81f7-06cc8e327aa3
          stepCounter: 402ca9fe-366f-4f95-94b1-b4a12ae036c0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RECORD_CREATED_DATE
        nullable: true
        recordCreated: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FIRST_VALUE ( {% if config.recordVersioning not in ('Integer Column') %} {{ order_by_col().split(',')[0] }} {% else %} {{ order_by_col_int().split(',')[0] }} {% endif %} ) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ORDERS: 23e9dbde-be57-4701-a60b-518adc3935a4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_DATA
            nodeName: ORDERS
        join:
          joinCondition: FROM {{ ref('SOURCE_DATA', 'ORDERS') }} "ORDERS" Where "O_ORDERKEY" = 9697
        name: ICDT_DIM_ORDERS
        noLinkRefs: []
  name: ICDT_DIM_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: "566"
  type: sql
  version: 1
type: Node
